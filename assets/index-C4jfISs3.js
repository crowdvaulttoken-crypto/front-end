import{h as O,a as s,e as P,j as t,I as V,B as z,k as L}from"./index-BP5gRy9n.js";import{P as H}from"./Page-CtSTrStg.js";import{u as Y}from"./useSmartContract-tYlQPVhx.js";import{u as G}from"./index.esm-CAUkKN03.js";import{C as J}from"./ConfirmModal-Dx8kkSYq.js";import{F as K}from"./ExclamationTriangleIcon-ByPSdAYk.js";import"./transition-DdYu76PD.js";import"./dialog-cd-iOxmb.js";function re(){const p=O(),{walletData:r,withdraw:h}=Y(),[w,x]=s.useState(0),[a,g]=s.useState(0),[S,{open:v,close:b}]=P(!1),[j,i]=s.useState(!1),[E,f]=s.useState(!1),[q,c]=s.useState(!1),[$,n]=s.useState(""),u=parseInt(r.coolDown),[k,A]=s.useState(()=>Math.floor(Date.now()/1e3)-u),F=q?"error":E?"success":"pending",C={pending:{Icon:K,title:"Withdrawal Request",description:"Click ok to confirm request.",actionText:"Ok"},success:{title:"Request Processing",description:"Thank You."},error:{description:`${$}`}},T=async()=>{i(!0);var e=!1,o=Math.floor(Date.now()/1e3);parseInt(r.coolDown)+86400>o?n("24 hrs withdrawal cooldown!"):a<5||a>100?n(`Widrawal Range Error ${a}`):w<a?n("Not enough rewards balance"):(e=await h(a),e||n("Transfer Failed")),e==!0?(i(!1),f(!0),c(!1),p("/dashboards")):(i(!1),c(!0))};s.useEffect(()=>{const e=setInterval(()=>{const o=Math.floor(Date.now()/1e3);A(o-u)},1e3);return()=>clearInterval(e)},[u]);const W=e=>{const o=Math.floor(e/86400),y=Math.floor(e%86400/3600),R=Math.floor(e%3600/60),B=e%60;return`${o}:${String(y).padStart(2,"0")}:${String(R).padStart(2,"0")}:${String(B).padStart(2,"0")}`},D=e=>{console.log(e),x(parseFloat(r.balance)),g(parseFloat(e.requestAmount)),f(!1),c(!1),v()},{register:I,handleSubmit:M,formState:{errors:l}}=G(),m=10,d=parseFloat(r.balance)<=100?parseFloat(r.balance):100,N={requestAmount:{required:"Enter Amount",min:{value:`${m}`,message:`Value must not less than ${m}`},max:{value:`${parseFloat(d)}`,message:`Value must not greater than ${d}`}}};return t.jsxs(H,{title:"Withdraw",children:[t.jsxs("div",{className:"transition-content w-full px-(--margin-x) pt-5 lg:pt-6",children:[t.jsx("div",{className:"min-w-0 mb-10",children:t.jsx("h2",{className:"truncate text-xl font-medium tracking-wide text-gray-800 dark:text-dark-50",children:"Withdraw"})}),t.jsxs("form",{onSubmit:M(D),children:[t.jsxs("label",{htmlFor:"requestAmount",children:["Enter the amount from ",m," - ",d," CrowdVault."]}),t.jsxs("div",{className:"mt-1.5 flex -space-x-px ",children:[t.jsx(V,{placeholder:"Enter amount",classNames:{root:"flex-1",input:"relative hover:z-1 focus:z-1 ltr:rounded-r-none rtl:rounded-l-none"},prefix:"$",type:"number",...I("requestAmount",N.requestAmount)}),t.jsx(z,{color:"primary",className:"ltr:rounded-l-none rtl:rounded-r-none",type:"submit",children:"Withdraw"})]}),"CoolDown Timer:  ",W(k),t.jsx(L,{when:l&&l?.message!=="",children:l?.requestAmount&&l.requestAmount.message})]})]}),t.jsx(J,{show:S,onClose:b,messages:C,onOk:T,confirmLoading:j,state:F})]})}export{re as default};
