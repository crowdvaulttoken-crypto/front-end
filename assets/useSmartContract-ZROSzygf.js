import{ae as At,af as xt,ag as B,ah as p,ai as k,aj as Ft,ak as Ct,al as Dt,am as L,an as R,a as u,ao as yt,ap as $}from"./index-Dez6lv9E.js";const It=BigInt(-1),g=BigInt(0),x=BigInt(1),Ut=BigInt(5),A={};let F="0000";for(;F.length<80;)F+=F;function _(r){let t=F;for(;t.length<r;)t+=t;return BigInt("1"+t.substring(0,r))}function D(r,t,n){const e=BigInt(t.width);if(t.signed){const i=x<<e-x;p(n==null||r>=-i&&r<i,"overflow","NUMERIC_FAULT",{operation:n,fault:"overflow",value:r}),r>g?r=L(R(r,e),e):r=-L(R(-r,e),e)}else{const i=x<<e;p(n==null||r>=0&&r<i,"overflow","NUMERIC_FAULT",{operation:n,fault:"overflow",value:r}),r=(r%i+i)%i&i-x}return r}function N(r){typeof r=="number"&&(r=`fixed128x${r}`);let t=!0,n=128,e=18;if(typeof r=="string"){if(r!=="fixed")if(r==="ufixed")t=!1;else{const l=r.match(/^(u?)fixed([0-9]+)x([0-9]+)$/);B(l,"invalid fixed format","format",r),t=l[1]!=="u",n=parseInt(l[2]),e=parseInt(l[3])}}else if(r){const l=r,c=(d,v,U)=>l[d]==null?U:(B(typeof l[d]===v,"invalid fixed format ("+d+" not "+v+")","format."+d,l[d]),l[d]);t=c("signed","boolean",t),n=c("width","number",n),e=c("decimals","number",e)}B(n%8===0,"invalid FixedNumber width (not byte aligned)","format.width",n),B(e<=80,"invalid FixedNumber decimals (too large)","format.decimals",e);const i=(t?"":"u")+"fixed"+String(n)+"x"+String(e);return{signed:t,width:n,decimals:e,name:i}}function Nt(r,t){let n="";r<g&&(n="-",r*=It);let e=r.toString();if(t===0)return n+e;for(;e.length<=t;)e=F+e;const i=e.length-t;for(e=e.substring(0,i)+"."+e.substring(i);e[0]==="0"&&e[1]!==".";)e=e.substring(1);for(;e[e.length-1]==="0"&&e[e.length-2]!==".";)e=e.substring(0,e.length-1);return n+e}class m{format;#n;#t;#e;_value;constructor(t,n,e){At(t,A,"FixedNumber"),this.#t=n,this.#n=e;const i=Nt(n,e.decimals);xt(this,{format:e.name,_value:i}),this.#e=_(e.decimals)}get signed(){return this.#n.signed}get width(){return this.#n.width}get decimals(){return this.#n.decimals}get value(){return this.#t}#i(t){B(this.format===t.format,"incompatible format; use fixedNumber.toFormat","other",t)}#r(t,n){return t=D(t,this.#n,n),new m(A,t,this.#n)}#a(t,n){return this.#i(t),this.#r(this.#t+t.#t,n)}addUnsafe(t){return this.#a(t)}add(t){return this.#a(t,"add")}#s(t,n){return this.#i(t),this.#r(this.#t-t.#t,n)}subUnsafe(t){return this.#s(t)}sub(t){return this.#s(t,"sub")}#o(t,n){return this.#i(t),this.#r(this.#t*t.#t/this.#e,n)}mulUnsafe(t){return this.#o(t)}mul(t){return this.#o(t,"mul")}mulSignal(t){this.#i(t);const n=this.#t*t.#t;return p(n%this.#e===g,"precision lost during signalling mul","NUMERIC_FAULT",{operation:"mulSignal",fault:"underflow",value:this}),this.#r(n/this.#e,"mulSignal")}#u(t,n){return p(t.#t!==g,"division by zero","NUMERIC_FAULT",{operation:"div",fault:"divide-by-zero",value:this}),this.#i(t),this.#r(this.#t*this.#e/t.#t,n)}divUnsafe(t){return this.#u(t)}div(t){return this.#u(t,"div")}divSignal(t){p(t.#t!==g,"division by zero","NUMERIC_FAULT",{operation:"div",fault:"divide-by-zero",value:this}),this.#i(t);const n=this.#t*this.#e;return p(n%t.#t===g,"precision lost during signalling div","NUMERIC_FAULT",{operation:"divSignal",fault:"underflow",value:this}),this.#r(n/t.#t,"divSignal")}cmp(t){let n=this.value,e=t.value;const i=this.decimals-t.decimals;return i>0?e*=_(i):i<0&&(n*=_(-i)),n<e?-1:n>e?1:0}eq(t){return this.cmp(t)===0}lt(t){return this.cmp(t)<0}lte(t){return this.cmp(t)<=0}gt(t){return this.cmp(t)>0}gte(t){return this.cmp(t)>=0}floor(){let t=this.#t;return this.#t<g&&(t-=this.#e-x),t=this.#t/this.#e*this.#e,this.#r(t,"floor")}ceiling(){let t=this.#t;return this.#t>g&&(t+=this.#e-x),t=this.#t/this.#e*this.#e,this.#r(t,"ceiling")}round(t){if(t==null&&(t=0),t>=this.decimals)return this;const n=this.decimals-t,e=Ut*_(n-1);let i=this.value+e;const l=_(n);return i=i/l*l,D(i,this.#n,"round"),new m(A,i,this.#n)}isZero(){return this.#t===g}isNegative(){return this.#t<g}toString(){return this._value}toUnsafeFloat(){return parseFloat(this.toString())}toFormat(t){return m.fromString(this.toString(),t)}static fromValue(t,n,e){const i=n==null?0:k(n),l=N(e);let c=Ft(t,"value");const d=i-l.decimals;if(d>0){const v=_(d);p(c%v===g,"value loses precision for format","NUMERIC_FAULT",{operation:"fromValue",fault:"underflow",value:t}),c/=v}else d<0&&(c*=_(-d));return D(c,l,"fromValue"),new m(A,c,l)}static fromString(t,n){const e=t.match(/^(-?)([0-9]*)\.?([0-9]*)$/);B(e&&e[2].length+e[3].length>0,"invalid FixedNumber string value","value",t);const i=N(n);let l=e[2]||"0",c=e[3]||"";for(;c.length<i.decimals;)c+=F;p(c.substring(i.decimals).match(/^0*$/),"too many decimals for format","NUMERIC_FAULT",{operation:"fromString",fault:"underflow",value:t}),c=c.substring(0,i.decimals);const d=BigInt(e[1]+l+c);return D(d,i,"fromString"),new m(A,d,i)}static fromBytes(t,n){let e=Ct(Dt(t,"value"));const i=N(n);return i.signed&&(e=L(e,i.width)),D(e,i,"fromBytes"),new m(A,e,i)}}function Tt(r,t){let n=18;return n=k(t,"unit"),m.fromValue(r,n,{decimals:n,width:512}).toString()}function T(r,t){B(typeof r=="string","value must be a string","value",r);let n=18;return n=k(t,"unit"),m.fromString(r,{decimals:n,width:512}).value}function S(r){return Tt(r,18)}const Lt=["function name() view returns (string)","function symbol() view returns (string)","function decimals() view returns (uint8)","function totalSupply() view returns (uint256)","function balanceOf(address) view returns (uint)","function allowance(address owner, address spender) view returns (uint256)","function approve(address spender, uint amount) returns (bool)","function transfer(address to, uint amount) returns (bool)","function transferFrom(address from, address to, uint amount) returns (bool)","event Transfer(address indexed from, address indexed to, uint amount)"],kt=["function owner() view returns (address)","function transferOwnership(address newOwner)","function renounceOwnership()","function register(address _referrer)","function depositBalance(uint256 _amount)","function activateVIP()","function activateAgent()","function collectPassive(uint8 _level)","function withdrawBalance(uint256 _amount)","function getAffiliateData(address _user) view returns (address parent, address agent, uint8 level, uint256 childrenCount)","function getAgentData(address _user) view returns (address parent, uint256 fees, uint256 totalIncome, bool isActive, uint256 childrenCount)","function getChildren(bool _isAffiliate, address _user, uint256 _startIndex, uint256 _count) view returns (address[] memory childrenBatch)","function getWalletData(address _user) view returns (uint256 balance, uint256 totalIncome, uint256 coolDown)","function getLastBlockTime(address _user) view returns (uint256)","function getLastBlockNumber(address _user) view returns (uint256)","function getVaultData(address _user, uint8 _level) view returns (uint256 amount, uint256 cap, uint256 coolDown)","function getPassiveReward(address _user, uint8 _level) view returns (uint256)","function getContractStats() view returns (uint256 totalUsers, uint256 totalAgents, uint256 contractBalance, uint256 _totalDeposits, uint256 _totalRewardsDistributed, uint256 _totalWithdrawals)","function getPoolGuardData() view returns (uint256 _poolThreshold, uint256 _highestBalance, uint256 _cooldownEndTime, bool _withdrawalsPaused)","function getActiveVault(address _user, uint256 reward) view returns (uint256 _level, uint256 _lowestCap)","function calculateUpgradeAmount(uint8 _level) view returns (uint256)","function calculateWithdrawAmount(uint256 _amount) pure returns (uint256)","function updateWalletData(address _user, uint256 _balance, uint256 _totalIncome, uint256 _coolDown)","function updateVaultData(address _user, uint8 _level, uint256 _amount, uint256 _coolDown, uint256 _cap)","function updateAffiliateData(address _user, address _parent, address _agent, uint8 _level)","function updateAgentData(address _user, address _parent, uint256 _fees, uint256 _totalIncome, bool _isActive)","function maxRank() view returns (uint8)","function maxCapped() view returns (uint8)","function maxOverRide() view returns (uint8)","function maxChildren() view returns (uint8)","function maxCooldown() view returns (uint8)","function maxIteration() view returns (uint8)","function maxTimeDelay() view returns (uint8)","function minWithdraw() view returns (uint256)","function maxWithdraw() view returns (uint256)","function regFee() view returns (uint256)","function entryFee() view returns (uint256)","function agentFee() view returns (uint256)","function rewardsReferral() view returns (uint256)","function rewardsOverRide() view returns (uint256)","function rewardsPassivePct() view returns (uint256)","function rewardsAgent() view returns (uint256)","function rewardsProjectFunds() view returns (uint256)","function rewardsBufferFunds() view returns (uint256)","function totalDeposits() view returns (uint256)","function totalRewardsDistributed() view returns (uint256)","function totalWithdrawals() view returns (uint256)","function totalProjectFunding() view returns (uint256)","function totalBufferFunding() view returns (uint256)","function vaults(address, uint8) view returns (uint256 amount, uint256 coolDown, uint256 cap)","function affiliates(address) view returns (address parent, address[] children, address agent, uint8 level)","function wallets(address) view returns (uint256 balance, uint256 totalIncome, uint256 coolDown)","function agents(address) view returns (address parent, address[] children, uint256 fees, uint256 totalIncome, bool isActive)","function userAccounts(uint256) view returns (address)","function agentAccounts(uint256) view returns (address)","event InternalTransfer(string method, address indexed from, address indexed to, uint256 amount)","event WithdrawBalance(address indexed from, address indexed to, uint256 amount)","event DepositBalance(address indexed from, address indexed to, uint256 amount)","event AffiliateUpdated(address indexed user, address indexed affiliate)","event SettingsUpdated(string settingName, uint256 newValue)","event AgentActivated(address indexed agent)","event AccountActivated(address indexed user, uint8 newLevel)","event Rewards(string rewardsName, address indexed from, address indexed to, uint256 newValue)"];function Wt(){const r="0xCb00624a76d66fEF68Dc156522dEf645e612b333",t="0x55d398326f99059fF775485246999027B3197955",[n,e]=u.useState(null),[i,l]=u.useState(null),[c,d]=u.useState(null),[v,U]=u.useState("0x0000000000000000000000000000000000000000"),[h,M]=u.useState("0x0000000000000000000000000000000000000000"),[z,P]=u.useState(!1),[a,O]=u.useState(null),[C,j]=u.useState(null),[q,H]=u.useState(0),[Z,G]=u.useState(0),[J,K]=u.useState(0),[Q,W]=u.useState([]),[X,Y]=u.useState([]),[tt,et]=u.useState(0),[nt,rt]=u.useState(0),[it,at]=u.useState(0),[st,ot]=u.useState(0),[ut,lt]=u.useState(0),[V,ct]=u.useState(!0);u.useEffect(()=>{if(typeof window>"u"||!window.ethereum){P(!1),console.warn("Ethereum provider not detected");return}const s=new yt(window.ethereum);l(s);const o=async()=>{try{const f=await s.getNetwork();if(e(f.name),f.name!=="bnb"){alert("Please switch to BNB Smart Chain.");return}const y=await s.send("eth_requestAccounts",[]);U(y[0]);const b=await s.getSigner();d(b);const w=await b.getAddress();M(w),P(w==y[0]);const I=await s.getBalance(w);H(S(I)),O(new $(r,kt,b)),j(new $(t,Lt,b)),a&&C&&V&&(ct(!1),W(await a.getWalletData(w)),K(await a.getWalletData(w).balance),at(await a.regFee()),ot(await a.entryFee()),lt(await a.agentFee()),rt(await a.getLastBlockTime(w)),et(await a.getLastBlockNumber(w)),W(await a.getWalletData(w)),Y(await a.getAffiliateData(w)),G(S(await C.balanceOf(w))))}catch(f){console.error(f)}};return o(),window.ethereum.on("chainChanged",o),window.ethereum.on("accountsChanged",o),()=>{window.ethereum&&(window.ethereum.removeListener("chainChanged",o),window.ethereum.removeListener("accountsChanged",o))}},[a,C,V]);const dt=s=>S(s),ft=async()=>!h||!a?{balance:0,totalIncome:0,coolDown:0}:await a.getWalletData(h),wt=async s=>!s||!a?{parent:"",merchant:"",level:0}:await a.getLastCallTime(s),gt=async()=>!h||!a?{parent:"",agent:"",level:0,childrenCount:0}:await a.getAffiliateData(h),ht=async s=>!h||!a?{amount:10,cap:0,coolDown:0,level:s}:await a.getVaultData(h,s),mt=async s=>{if(!a)return!1;try{const o=await a.connect(c).register(s);return await o.wait(),!!o}catch(o){return console.error(o),alert(o),!1}},vt=async s=>{if(!a)return!1;try{if(await St(T(s.toString(),18))==!0){const f=await a.depositBalance(T(s.toString(),18));return await f.wait(),f?(console.log(`Transaction Hash: ${f.hash}`),!0):!1}}catch(o){return console.error(o),alert(o),!1}},pt=async()=>{if(!h||!a)return!1;try{console.log(`Signer Address: ${h}`);const s=await a.activateVIP();return await s.wait(),s?(console.log(`Transaction Hash: ${s.hash}`),!0):!1}catch(s){return console.error(s),alert(s),!1}},bt=async s=>{try{const o=await a.withdrawBalance(T(s.toString(),18));return await o.wait(),!!o}catch(o){return console.error("Withdrawal failed:",o),alert(o),!1}},_t=u.useCallback(async s=>{if(!s||!a)return{children:[],affiliates:[]};const o=await a.getChildren(!0,s,0,100),f=await Promise.all(o.map(async b=>{const[w,I,E]=await a.getAffiliateData(b);return console.log(`Parent: ${w}`),console.log(`agent: ${I}`),console.log(`level: ${E}`),{address:b,level:E,parent:w,agent:I}})),y=await a.getAffiliateData(s);return{children:f,affiliates:y}},[a]),St=async s=>{try{if(await C.allowance(v,r)<s){const f=await C.approve(r,s);return await f.wait(),f?(console.log(`Approved ${S(s)} tokens for spending`),!0):!1}return!0}catch(o){return console.error(o),!1}},Bt=u.useCallback(async()=>{if(!a)return{brokerFee:0,entryFee:0};const s=await a.regFee(),o=await a.entryFee(),f=await a.agentFee();return{regFee:S(s),entryFee:S(o),agentFee:S(f)}},[a]);return{network:n,provider:i,signer:c,account:v,address:h,connected:z,CrowdVaultContract:a,affiliateData:X,walletData:Q,bnbBalance:q,usdtBalance:Z,vaultBalance:J,lastBlockTime:nt,lastBlockNumber:tt,agentFee:ut,entryFee:st,regFee:it,getWalletData:ft,getAffiliateData:gt,getVaultData:ht,convertWeiToEther:dt,registerWallet:mt,getLastCallTime:wt,getChildren:_t,activateVIP:pt,getFees:Bt,withdraw:bt,deposit:vt}}export{Wt as u};
